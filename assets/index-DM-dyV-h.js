import{b as P,w as $,C as A,g as R,V as U}from"./index-DaqVckEH.js";import{d as w,r as x,o as r,f as V,w as f,h as m,u as i,b as _,g as C,R as B,i as T,k as j,s as E,W as F,c as y,F as I,a as L}from"./index-Codx0prs.js";const M=w({__name:"index",props:{defaultText:{default:""}},emits:["submit"],setup(p,{emit:o}){const e=p,n=o,c=x(e.defaultText);function h(d){c.value=(d==null?void 0:d.trim())||e.defaultText,n("submit",c.value)}function g(d){c.value=d}return(d,k)=>(r(),V(i(R),{class:"select-none cursor-text","activation-mode":"dblclick","default-value":d.defaultText,"model-value":i(c),onSubmit:h,"onUpdate:modelValue":g},{default:f(()=>[m(i(P),null,{default:f(()=>[m(i($)),m(i(A),{class:"w-full p-1 outline-none"})]),_:1})]),_:1},8,["default-value","model-value"]))}}),v={class:"flex items-center justify-center text-gray-500"},z=w({__name:"index",setup(p){const o=x(!0);return(e,n)=>(r(),V(i(U),{checked:i(o),"onUpdate:checked":n[0]||(n[0]=c=>B(o)?o.value=c:null),class:"flex items-center justify-center outline-none"},{default:f(()=>[_("div",v,[i(o)?C(e.$slots,"checked-icon",{key:0}):C(e.$slots,"unchecked-icon",{key:1})])]),_:3},8,["checked"]))}}),D={class:"flex flex-col space-y-2 py-2"},H=["onClick"],K=["onClick"],O=["src","alt"],J=w({__name:"index",setup(p){const o=x([]),e=T("visu"),n=e==null?void 0:e.getPlugin("VisuPluginWorkspace"),c=e==null?void 0:e.getPlugin("VisuPluginZoom"),h=x(1);j(()=>{const t=(n==null?void 0:n.nodes)||[];o.value=t.map(l=>d(l)).sort((l,s)=>s.index-l.index),E.on("visu-workspace",g)});function g(t){if(t.type==="add"){const l=d(t.node);o.value.unshift(l)}}function d(t){const l=e==null?void 0:e.getCanvasSize(),s=e==null?void 0:e.getCanvasPosition();return{id:t.id(),name:k(t.id(),t.name()),index:t.zIndex(),dataUrl:t.toDataURL({x:s==null?void 0:s.x,y:s==null?void 0:s.y,width:((l==null?void 0:l.width)||0)*((c==null?void 0:c.zoom)||1),height:((l==null?void 0:l.height)||0)*((c==null?void 0:c.zoom)||1)})}}function k(t,l){const s=o.value.find(b=>b.id===t),u=n==null?void 0:n.getNode(t);let a=l;return a?a===F.CANVAS&&(a="画布"):(a=`未命名${h.value}`,h.value+=1),s&&(s.name=a),u==null||u.setAttr("name",a),a}function N(t){n==null||n.hideNode(t)}function S(t){n==null||n.showNode(t)}return(t,l)=>{const s=z,u=M;return r(),y("div",D,[(r(!0),y(I,null,L(i(o),a=>(r(),y("div",{key:a.id,class:"flex items-center space-x-4 bg-gray-100 p-2 rounded-sm cursor-pointer"},[m(s,null,{"checked-icon":f(()=>[_("i",{class:"i-lucide-eye",onClick:()=>N(a.id)},null,8,H)]),"unchecked-icon":f(()=>[_("i",{class:"i-lucide-eye-off",onClick:()=>S(a.id)},null,8,K)]),_:2},1024),_("img",{class:"w-60px select-none bg-black-white-10",style:{"-webkit-user-drag":"none"},src:a.dataUrl,alt:a.name},null,8,O),m(u,{class:"text-xs break-all line-clamp-1","default-text":a.name,placeholder:a.name,onSubmit:b=>k(a.id,b)},null,8,["default-text","placeholder","onSubmit"])]))),128))])}}});export{J as default};
