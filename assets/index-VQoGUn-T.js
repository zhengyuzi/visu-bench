var y=Object.defineProperty;var M=(t,e,n)=>e in t?y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var s=(t,e,n)=>M(t,typeof e!="symbol"?e+"":e,n);import{L as b,s as x,d as E,i as D,r as w,o as r,c,F as L,a as O,b as d,n as h,u as m,V}from"./index-Codx0prs.js";class B{constructor(e,n={}){s(this,"name","VisuPluginDrag");s(this,"main");s(this,"isOpen",!1);s(this,"isDrag",!1);s(this,"drag",{x:0,y:0});s(this,"_handleMousedown",this.handleMousedown.bind(this));s(this,"_handleMousemove",this.handleMousemove.bind(this));s(this,"_handleMouseup",this.handleMouseup.bind(this));this.stage=e,this.main=e.findOne(`#${b.MAIN}`)}open(){this.isOpen||(this.isOpen=!0,this.stage.container().style.cursor="grab",this.stage.on("mousedown",this._handleMousedown))}close(){this.isOpen&&(this.stage.container().style.cursor="default",this.isOpen=!1,this.stage.off("mousedown",this._handleMousedown),document.removeEventListener("mousemove",this._handleMousemove),document.removeEventListener("mouseup",this._handleMouseup))}handleMousedown(e){this.stage.container().style.cursor==="grab"&&(this.stage.container().style.cursor="grabbing"),this.isDrag=!0,this.drag.x=e.evt.clientX,this.drag.y=e.evt.clientY,document.addEventListener("mousemove",this._handleMousemove),document.addEventListener("mouseup",this._handleMouseup),e.evt.preventDefault()}handleMousemove(e){if(this.isDrag){const{x:n,y:i}=this.main.position();this.stage.container().style.cursor="grabbing",this.main.position({x:n+e.clientX-this.drag.x,y:i+e.clientY-this.drag.y}),this.drag.x=e.clientX,this.drag.y=e.clientY,this.main.draw(),x.emit("visu-drag",{x:e.movementX,y:e.movementY})}}handleMouseup(){this.isDrag=!1,this.isOpen&&(this.main.getStage().container().style.cursor="grab"),document.removeEventListener("mousemove",this._handleMousemove),document.removeEventListener("mouseup",this._handleMouseup)}}const S={class:"w-full h-full flex flex-col items-center space-y-2 py-2"},k=["title","onClick"],Y=E({__name:"index",setup(t){const e=D("visu"),n=w(0),i=[{name:"移动",iconName:"i-mage-mouse-pointer",bindEvent:()=>f(),unBindEvent:()=>_()},{name:"拖动",iconName:"i-clarity-cursor-hand-open-line",bindEvent:()=>p(),unBindEvent:()=>v()}];function g(o){if(n.value!==o){const l=i[o];i[n.value].unBindEvent(),l.bindEvent(),n.value=o}}function p(){e==null||e.use(B)}function v(){e==null||e.unuse("VisuPluginDrag")}function f(){e==null||e.use(V)}function _(){e==null||e.unuse("VisuPluginSelection")}return(o,l)=>(r(),c("div",S,[(r(),c(L,null,O(i,(a,u)=>d("button",{key:a.name,class:h(["relative cursor-pointer p-1 rounded active:scale-90",u===m(n)?"bg-indigo-500":""]),title:a.name,onClick:()=>g(u)},[d("i",{class:h(["flex text-xl",[a.iconName,u===m(n)?"text-gray-100":"text-gray-600"]])},null,2)],10,k)),64))]))}});export{Y as default};
